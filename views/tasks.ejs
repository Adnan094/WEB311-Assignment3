<h2>My Tasks</h2>

<p><a href="/tasks/add">Add New Task</a></p>

<% if (!tasks || tasks.length === 0) { %>
  <p>No tasks yet.</p>
<% } else { %>
  <table border="1" cellpadding="6" cellspacing="0">
    <thead>
      <tr>
        <th>Title</th>
        <th>Status</th>
        <th>Due Date</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% tasks.forEach(t => { %>
        <tr>
          <td><%= t.title %></td>
          <td><%= t.status %></td>
          <td><%= t.dueDate ? (new Date(t.dueDate)).toISOString().split('T')[0] : 'N/A' %></td>
          <td>
            <form action="/tasks/status/<%= t.id %>" method="POST" style="display:inline">
              <button type="submit"><%= t.status === 'pending' ? 'Mark Completed' : 'Mark Pending' %></button>
            </form>
            <a href="/tasks/edit/<%= t.id %>">Edit</a>
            <form action="/tasks/delete/<%= t.id %>" method="POST" style="display:inline" onsubmit="return confirm('Delete?');">
              <button type="submit">Delete</button>
            </form>
          </td>
        </tr>
      <% }); %>
    </tbody>
  </table>
<% } %>
